generator client {
provider = "prisma-client-js"
}


datasource db {
  provider = "sqlite"
  url      = env("DATABASE_URL")
}


enum Status {
PENDING
APPROVED
REJECTED
}


enum ActionType {
APPROVE
REJECT
}


model ApprovalRequest {
id String @id @default(cuid())
site String
trade String
tendersIssued Int
tendersReceived Int
budgetValue     Decimal
estimatedProfit Decimal
comments String?
requesterEmail String
status Status @default(PENDING)
recommendedBidId String?


bids Bid[]
actions ApprovalAction[]


createdAt DateTime @default(now())
updatedAt DateTime @updatedAt
}


model Bid {
id String @id @default(cuid())
approvalRequestId String
contractor String
quote           Decimal


approvalRequest ApprovalRequest @relation(fields: [approvalRequestId], references: [id], onDelete: Cascade)
}


model ApprovalAction {
id String @id @default(cuid())
approvalRequestId String
actorEmail String
action ActionType
notes String?
createdAt DateTime @default(now())


approvalRequest ApprovalRequest @relation(fields: [approvalRequestId], references: [id], onDelete: Cascade)
}